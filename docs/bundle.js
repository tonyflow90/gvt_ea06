!function(){"use strict";var t="undefined"!=typeof Float32Array?Float32Array:Array;function e(){var e=new t(16);return t!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function r(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});let i={createVertexData:function(){let t=100,e=100;this.vertices=new Float32Array(30603);let r=this.vertices;this.normals=new Float32Array(30603);let i=this.normals;this.indicesLines=new Uint16Array(4e4);let a=this.indicesLines;this.indicesTris=new Uint16Array(6e4);let n=this.indicesTris,o=0,s=0;for(let l=0,c=-10;l<=t;l++,c+=.2)for(let t=0,f=-10;t<=e;t++,f+=.2){let e=101*l+t,h=c,A=0,u=f;r[3*e]=h,r[3*e+1]=A,r[3*e+2]=u,i[3*e]=0,i[3*e+1]=1,i[3*e+2]=0,t>0&&l>0&&(a[o++]=e-1,a[o++]=e),t>0&&l>0&&(a[o++]=e-101,a[o++]=e),t>0&&l>0&&(n[s++]=e,n[s++]=e-1,n[s++]=e-101,n[s++]=e-1,n[s++]=e-101-1,n[s++]=e-101)}return{vertices:r,normals:i,indicesLines:a,indicesTris:n}}},a={createVertexData:function(){this.vertices=new Float32Array(108);let t=this.vertices;this.normals=new Float32Array(108);let e=this.normals;this.indicesLines=new Uint16Array(100);let r=this.indicesLines;this.indicesTris=new Uint16Array(150);let i=this.indicesTris,a=2*Math.PI/5,n=Math.PI/5,o=0,s=0;for(let l=0,c=0;l<=5;l++,c+=a)for(let a=0,f=0;a<=5;a++,f+=n){let n=6*l+a,h=1*Math.sin(f)*Math.cos(c),A=1*Math.sin(f)*Math.sin(c),u=1*Math.cos(f);t[3*n]=h,t[3*n+1]=A,t[3*n+2]=u;let b=Math.sqrt(h*h+A*A+u*u);e[3*n]=h/b,e[3*n+1]=A/b,e[3*n+2]=u/b,a>0&&l>0&&(r[o++]=n-1,r[o++]=n),a>0&&l>0&&(r[o++]=n-6,r[o++]=n),a>0&&l>0&&(i[s++]=n,i[s++]=n-1,i[s++]=n-6,i[s++]=n-1,i[s++]=n-6-1,i[s++]=n-6)}return{vertices:t,normals:e,indicesLines:r,indicesTris:i}}},n={createVertexData:function(){let t=16,e=32;this.vertices=new Float32Array(1683);let r=this.vertices;this.normals=new Float32Array(1683);let i=this.normals;this.indicesLines=new Uint16Array(2048);let a=this.indicesLines;this.indicesTris=new Uint16Array(3072);let n=this.indicesTris,o=2*Math.PI/t,s=2*Math.PI/e,l=0,c=0;for(let f=0,h=0;f<=t;f++,h+=o)for(let t=0,o=0;t<=e;t++,o+=s){let e=33*f+t,s=(.5+.3*Math.cos(h))*Math.cos(o),A=(.5+.3*Math.cos(h))*Math.sin(o),u=.3*Math.sin(h);r[3*e]=s,r[3*e+1]=A,r[3*e+2]=u;let b=Math.cos(h)*Math.cos(o),M=Math.cos(h)*Math.sin(o),v=Math.sin(h);i[3*e]=b,i[3*e+1]=M,i[3*e+2]=v,t>0&&f>0&&(a[l++]=e-1,a[l++]=e),t>0&&f>0&&(a[l++]=e-33,a[l++]=e),t>0&&f>0&&(n[c++]=e,n[c++]=e-1,n[c++]=e-33,n[c++]=e-1,n[c++]=e-33-1,n[c++]=e-33)}return{vertices:r,normals:i,indicesLines:a,indicesTris:n}}},o=function(){let t,o,s,l=[],c={eye:[0,1,4],center:[0,0,0],up:[0,1,0],fovy:60*Math.PI/180,lrtb:2,vMatrix:e(),pMatrix:e(),projectionType:"perspective",zAngle:0,distance:4};function f(e,r){let i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:(console.log(SourceTagId+": "+t.getShaderInfoLog(i)),null)}function h(r,i,a,n,s){let c={};c.fillstyle=i,function(e,r){Object.assign(e,r),e.vboPos=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,e.vboPos),t.bufferData(t.ARRAY_BUFFER,e.vertices,t.STATIC_DRAW),o.positionAttrib=t.getAttribLocation(o,"aPosition"),t.enableVertexAttribArray(o.positionAttrib),e.vboNormal=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,e.vboNormal),t.bufferData(t.ARRAY_BUFFER,e.normals,t.STATIC_DRAW),o.normalAttrib=t.getAttribLocation(o,"aNormal"),t.enableVertexAttribArray(o.normalAttrib),e.iboLines=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.iboLines),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e.indicesLines,t.STATIC_DRAW),e.iboLines.numberOfElements=e.indicesLines.length,t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),e.iboTris=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.iboTris),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e.indicesTris,t.STATIC_DRAW),e.iboTris.numberOfElements=e.indicesTris.length,t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}(c,r),function(t,r,i,a){t.translate=r,t.rotate=i,t.scale=a,t.mMatrix=e(),t.mvMatrix=e()}(c,a,n,s),l.push(c)}function A(t=0,e=1,r=0,i=0){let a=0,n=0;return a=e*Math.cos(t),n=e*Math.sin(t),a+=r,n+=i,[a,n]}function u(){var e,i,a,n,s,f,h,A,u,v,m,d,y,E,R,x,T,F,g,p,L,_,w;t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),function(){let e;switch(c.projectionType){case"ortho":e=c.lrtb,r=c.pMatrix,h=1/((i=-e)-(a=e)),A=1/((n=-e)-(s=e)),u=1/((l=-10)-(f=10)),r[0]=-2*h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*A,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*u,r[11]=0,r[12]=(i+a)*h,r[13]=(s+n)*A,r[14]=(f+l)*u,r[15]=1;break;case"frustum":e=c.lrtb,function(t,e,r,i,a,n,o){var s=1/(r-e),l=1/(a-i),c=1/(n-o);t[0]=2*n*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*n*l,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(a+i)*l,t[10]=(o+n)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*n*2*c,t[15]=0}(c.pMatrix,-e/2,e/2,-e/2,e/2,1,10);break;case"perspective":!function(t,e,r,i,a){var n,o=1/Math.tan(e/2);t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=a&&a!==1/0?(n=1/(i-a),t[10]=(a+i)*n,t[14]=2*a*i*n):(t[10]=-1,t[14]=-2*i)}(c.pMatrix,c.fovy,c.aspect,1,10)}var r,i,a,n,s,l,f,h,A,u;t.uniformMatrix4fv(o.pMatrixUniform,!1,c.pMatrix)}(),c.eye[0]=c.center[0],c.eye[2]=c.center[2],c.eye[0]+=c.distance*Math.sin(c.zAngle),c.eye[2]+=c.distance*Math.cos(c.zAngle),e=c.vMatrix,i=c.eye,a=c.center,n=c.up,R=i[0],x=i[1],T=i[2],F=n[0],g=n[1],p=n[2],L=a[0],_=a[1],w=a[2],Math.abs(R-L)<1e-6&&Math.abs(x-_)<1e-6&&Math.abs(T-w)<1e-6?r(e):(m=R-L,d=x-_,y=T-w,s=g*(y*=E=1/Math.hypot(m,d,y))-p*(d*=E),f=p*(m*=E)-F*y,h=F*d-g*m,(E=Math.hypot(s,f,h))?(s*=E=1/E,f*=E,h*=E):(s=0,f=0,h=0),A=d*h-y*f,u=y*s-m*h,v=m*f-d*s,(E=Math.hypot(A,u,v))?(A*=E=1/E,u*=E,v*=E):(A=0,u=0,v=0),e[0]=s,e[1]=A,e[2]=m,e[3]=0,e[4]=f,e[5]=u,e[6]=d,e[7]=0,e[8]=h,e[9]=v,e[10]=y,e[11]=0,e[12]=-(s*R+f*x+h*T),e[13]=-(A*R+u*x+v*T),e[14]=-(m*R+d*x+y*T),e[15]=1);for(let e=0;e<l.length;e++)b(l[e]),t.uniformMatrix4fv(o.mvMatrixUniform,!1,l[e].mvMatrix),M(l[e])}function b(t){let e=t.mMatrix,i=t.mvMatrix;var a,n,o,s,l,f,h,A,u,b,M,v,m,d,y,E,R,x;r(e),r(i),a=e,n=e,o=t.translate,E=o[0],R=o[1],x=o[2],n===a?(a[12]=n[0]*E+n[4]*R+n[8]*x+n[12],a[13]=n[1]*E+n[5]*R+n[9]*x+n[13],a[14]=n[2]*E+n[6]*R+n[10]*x+n[14],a[15]=n[3]*E+n[7]*R+n[11]*x+n[15]):(s=n[0],l=n[1],f=n[2],h=n[3],A=n[4],u=n[5],b=n[6],M=n[7],v=n[8],m=n[9],d=n[10],y=n[11],a[0]=s,a[1]=l,a[2]=f,a[3]=h,a[4]=A,a[5]=u,a[6]=b,a[7]=M,a[8]=v,a[9]=m,a[10]=d,a[11]=y,a[12]=s*E+A*R+v*x+n[12],a[13]=l*E+u*R+m*x+n[13],a[14]=f*E+b*R+d*x+n[14],a[15]=h*E+M*R+y*x+n[15]),function(t,e,r){var i=Math.sin(r),a=Math.cos(r),n=e[4],o=e[5],s=e[6],l=e[7],c=e[8],f=e[9],h=e[10],A=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=n*a+c*i,t[5]=o*a+f*i,t[6]=s*a+h*i,t[7]=l*a+A*i,t[8]=c*a-n*i,t[9]=f*a-o*i,t[10]=h*a-s*i,t[11]=A*a-l*i}(e,e,t.rotate[0]),function(t,e,r){var i=Math.sin(r),a=Math.cos(r),n=e[0],o=e[1],s=e[2],l=e[3],c=e[8],f=e[9],h=e[10],A=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*a-c*i,t[1]=o*a-f*i,t[2]=s*a-h*i,t[3]=l*a-A*i,t[8]=n*i+c*a,t[9]=o*i+f*a,t[10]=s*i+h*a,t[11]=l*i+A*a}(e,e,t.rotate[1]),function(t,e,r){var i=Math.sin(r),a=Math.cos(r),n=e[0],o=e[1],s=e[2],l=e[3],c=e[4],f=e[5],h=e[6],A=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*a+c*i,t[1]=o*a+f*i,t[2]=s*a+h*i,t[3]=l*a+A*i,t[4]=c*a-n*i,t[5]=f*a-o*i,t[6]=h*a-s*i,t[7]=A*a-l*i}(e,e,t.rotate[2]),function(t,e,r){var i=r[0],a=r[1],n=r[2];t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(e,e,t.scale),function(t,e,r){var i=e[0],a=e[1],n=e[2],o=e[3],s=e[4],l=e[5],c=e[6],f=e[7],h=e[8],A=e[9],u=e[10],b=e[11],M=e[12],v=e[13],m=e[14],d=e[15],y=r[0],E=r[1],R=r[2],x=r[3];t[0]=y*i+E*s+R*h+x*M,t[1]=y*a+E*l+R*A+x*v,t[2]=y*n+E*c+R*u+x*m,t[3]=y*o+E*f+R*b+x*d,y=r[4],E=r[5],R=r[6],x=r[7],t[4]=y*i+E*s+R*h+x*M,t[5]=y*a+E*l+R*A+x*v,t[6]=y*n+E*c+R*u+x*m,t[7]=y*o+E*f+R*b+x*d,y=r[8],E=r[9],R=r[10],x=r[11],t[8]=y*i+E*s+R*h+x*M,t[9]=y*a+E*l+R*A+x*v,t[10]=y*n+E*c+R*u+x*m,t[11]=y*o+E*f+R*b+x*d,y=r[12],E=r[13],R=r[14],x=r[15],t[12]=y*i+E*s+R*h+x*M,t[13]=y*a+E*l+R*A+x*v,t[14]=y*n+E*c+R*u+x*m,t[15]=y*o+E*f+R*b+x*d}(i,c.vMatrix,e)}function M(e){t.bindBuffer(t.ARRAY_BUFFER,e.vboPos),t.vertexAttribPointer(o.positionAttrib,3,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e.vboNormal),t.vertexAttribPointer(o.normalAttrib,3,t.FLOAT,!1,0,0),-1!=e.fillstyle.search(/fill/)&&(t.enableVertexAttribArray(o.normalAttrib),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.iboTris),t.drawElements(t.TRIANGLES,e.iboTris.numberOfElements,t.UNSIGNED_SHORT,0)),-1!=e.fillstyle.search(/wireframe/)&&(t.disableVertexAttribArray(o.normalAttrib),t.vertexAttrib3f(o.normalAttrib,0,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.iboLines),t.drawElements(t.LINES,e.iboLines.numberOfElements,t.UNSIGNED_SHORT,0))}return{start:function(){(function(){let e=document.getElementById("canvas");t=e.getContext("webgl"),t.viewportWidth=e.width,t.viewportHeight=e.height})(),function(){let e=f(t.VERTEX_SHADER,"\n    attribute vec3 aPosition;\n    attribute vec3 aNormal;\n\n    uniform mat4 uPMatrix;\n    uniform mat4 uMVMatrix;\n\n    varying vec4 vColor;\n\n    void main(){\n    gl_Position = uPMatrix * uMVMatrix * vec4(aPosition, 1.0);\n\n    vColor = vec4(aNormal.x, aNormal.y, aNormal.z, 1.0);\n    vColor = (vColor + 1.0) / 2.0;\n    }\n"),r=f(t.FRAGMENT_SHADER,"\n    precision mediump float;\n    varying vec4 vColor;\n\n    void main() {\n    gl_FragColor = vColor;\n    }\n");o=t.createProgram(),t.attachShader(o,e),t.attachShader(o,r),t.bindAttribLocation(o,0,"aPosition"),t.linkProgram(o),t.useProgram(o)}(),o.pMatrixUniform=t.getUniformLocation(o,"uPMatrix"),o.mvMatrixUniform=t.getUniformLocation(o,"uMVMatrix"),function(){let t="fillwireframe";h(n.createVertexData(),t,[0,0,0],[0,0,0],[1,1,1]),h(i.createVertexData(),"wireframe",[0,-.8,0],[0,0,0],[1,1,1]);let e=2*Math.PI/60,r=3*e,o=6*e,c=9*e;console.log(0,r,o,c);let[f,u]=[0,0];[f,u]=A(0,1,-1),h(a.createVertexData(),t,[f,0,u],[0,0,0],[.15,.15,.15]),l[2].xyAngle=0,[f,u]=A(r,1,-1),h(a.createVertexData(),t,[f,0,u],[0,0,0],[.15,.15,.15]),l[3].xyAngle=r,[f,u]=A(o,1,-1),h(a.createVertexData(),t,[f,0,u],[0,0,0],[.15,.15,.15]),l[4].xyAngle=o,[f,u]=A(c,1,-1),h(a.createVertexData(),t,[f,0,u],[0,0,0],[.15,.15,.15]),l[5].xyAngle=c,s=l[0]}(),function(){let t=Math.PI/60;window.onkeydown=function(e){let r=e.which?e.which:e.keyCode,i=String.fromCharCode(r),a=e.shiftKey?-1:1;switch(i){case"K":s.rotate[1]+=a*t;let e=1,r=2*Math.PI/60;l[2].xyAngle+=r,l[3].xyAngle+=r,l[4].xyAngle+=r,l[5].xyAngle+=r;let[i,n]=[0,0];[i,n]=A(l[2].xyAngle,e,-1),l[2].translate[0]=i,l[2].translate[2]=n,[i,n]=A(l[3].xyAngle,e,-1),l[3].translate[0]=i,l[3].translate[2]=n,[i,n]=A(l[4].xyAngle,e,-1),l[4].translate[0]=i,l[4].translate[2]=n,[i,n]=A(l[5].xyAngle,e,-1),l[5].translate[0]=i,l[5].translate[2]=n}switch(i){case"O":c.projectionType="ortho",c.lrtb=2;break;case"F":c.projectionType="frustum",c.lrtb=1.2;break;case"P":c.projectionType="perspective"}switch(i){case"C":c.zAngle+=a*t;break;case"H":c.eye[1]+=.05*a;break;case"D":c.distance+=.05*a;break;case"V":c.fovy+=5*a*Math.PI/180;break;case"B":c.lrtb+=.1*a}u()}}(),t.clearColor(.95,.95,.95,1),t.frontFace(t.CCW),t.enable(t.CULL_FACE),t.cullFace(t.BACK),t.enable(t.DEPTH_TEST),t.enable(t.POLYGON_OFFSET_FILL),t.polygonOffset(.5,0),t.viewport(0,0,t.viewportWidth,t.viewportHeight),c.aspect=t.viewportWidth/t.viewportHeight,u()}}}();document.body.onload=()=>{o.start()}}();
//# sourceMappingURL=bundle.js.map
